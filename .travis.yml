os:
- linux
dist: trusty
language: generic
sudo: false
cache:
  apt: true
  directories:
    - $HOME/.cabal
    - $HOME/.ghc
addons:
  apt:
    sources:
      - sourceline: 'ppa:jonathonf/texlive-2016'
    packages:
    - texlive
    - texlive-lang-cjk
    - texlive-lang-japanese
    - dvipsk-ja
    - xdvik-ja
    - gv
    - texlive-fonts-recommended
    - texlive-fonts-extra
    - ruby-dev
    - build-essential
    - cabal-install
    - ghc

install:
- export PATH=$PATH:~/.cabal/bin
- cabal update
- cabal install cabal-install
- hash -r
- cabal install --user pandoc pandoc-crossref --upgrade-dependencies

script:
- make clean all

before_cache:
  - cabal list --installed --simple-output
  - rm -f $HOME/.cabal/logs/*.log
